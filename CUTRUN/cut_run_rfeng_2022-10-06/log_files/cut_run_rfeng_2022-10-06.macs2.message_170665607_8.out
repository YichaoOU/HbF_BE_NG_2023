null device 
          1 
null device 
          1 
null device 
          1 
null device 
          1 
[1] 37.21308
null device 
          1 
Number of query regions: 95718
Number of assigned query regions by Exon: 9004
Number of assigned query regions by Promoter: 21565
Number of assigned query regions by 5UTR: 2310
Number of assigned query regions by 3UTR: 2093
Number of assigned query regions by Intron: 63451
  query_chr  query_start  ...          Intron_gene Genomic_features
0      chr1        29885  ...                    .             Exon
1      chr1        30748  ...  ENSG00000243485.5_6         Promoter
2      chr1        32474  ...                    .       Intergenic
3      chr1        38602  ...                    .       Intergenic
4      chr1        42130  ...                    .       Intergenic

[5 rows x 14 columns]
These categories are not found: 5UTR, 3UTR
HUDEP2_GATA1_S1.bam
HUDEP2_GATA1_S1.vs.HUDEP2_IgG_S9_peaks.rmblck.narrowPeak


                  Name  FRIP_CHIP
0  HUDEP2_GATA1_S1.bam   0.505885
Number of query regions: 111659
Number of assigned query regions by Exon: 10270
Number of assigned query regions by Promoter: 24302
Number of assigned query regions by 5UTR: 2527
Number of assigned query regions by 3UTR: 2480
Number of assigned query regions by Intron: 74973
  query_chr  ...  Genomic_features
0      chr1  ...        Intergenic
1      chr1  ...            Intron
2      chr1  ...          Promoter
3      chr1  ...          Promoter
4      chr1  ...              Exon

[5 rows x 14 columns]
These categories are not found: 5UTR, 3UTR
HUDEP2_GATA1_S1.rmdup.uq.rmchrM.bam
HUDEP2_GATA1_S1.vs.HUDEP2_IgG_S9.rmdup.uq.rmchrM_peaks.rmblck.narrowPeak


                                  Name  FRIP_CHIP
0  HUDEP2_GATA1_S1.rmdup.uq.rmchrM.bam   0.526372
Number of query regions: 121725
Number of assigned query regions by Exon: 10933
Number of assigned query regions by Promoter: 26069
Number of assigned query regions by 5UTR: 2611
Number of assigned query regions by 3UTR: 2617
Number of assigned query regions by Intron: 80172
  query_chr  query_start  ...          Intron_gene Genomic_features
0      chr1        27646  ...  ENSG00000227232.5_3         Promoter
1      chr1        29865  ...                    .             Exon
2      chr1        30743  ...  ENSG00000243485.5_6         Promoter
3      chr1        31404  ...                    .         Promoter
4      chr1        32474  ...                    .       Intergenic

[5 rows x 14 columns]
These categories are not found: 5UTR, 3UTR
HUDEP2_GATA1_S1.rmdup.bam
HUDEP2_GATA1_S1.vs.HUDEP2_IgG_S9.rmdup_peaks.rmblck.narrowPeak


                        Name  FRIP_CHIP
0  HUDEP2_GATA1_S1.rmdup.bam    0.51542
Number of query regions: 89107
Number of assigned query regions by Exon: 8480
Number of assigned query regions by Promoter: 20359
Number of assigned query regions by 5UTR: 2197
Number of assigned query regions by 3UTR: 2010
Number of assigned query regions by Intron: 60100
  query_chr  ...  Genomic_features
0      chr1  ...        Intergenic
1      chr1  ...            Intron
2      chr1  ...          Promoter
3      chr1  ...          Promoter
4      chr1  ...              Exon

[5 rows x 14 columns]
These categories are not found: 5UTR, 3UTR
HUDEP2_GATA1_S1.markdup.uq.bam
HUDEP2_GATA1_S1.vs.HUDEP2_IgG_S9.markdup.uq_peaks.rmblck.narrowPeak


                             Name  FRIP_CHIP
0  HUDEP2_GATA1_S1.markdup.uq.bam    0.55793
Calling enriched regions with control file
Normalizing control to experimental bedgraph
Using relaxed threshold
Creating experimental AUC file: Thu Oct  6 14:43:46 CDT 2022
Creating control AUC file: Thu Oct  6 14:43:46 CDT 2022
Calculating optimal AUC threshold: Thu Oct  6 14:43:46 CDT 2022
Calculating threshold using normalized control: Thu Oct  6 14:43:46 CDT 2022
Calling enriched regions with control file
Normalizing control to experimental bedgraph
Using relaxed threshold
Creating experimental AUC file: Thu Oct  6 14:43:46 CDT 2022
Creating control AUC file: Thu Oct  6 14:44:01 CDT 2022
Calculating optimal AUC threshold: Thu Oct  6 14:44:17 CDT 2022
Calculating threshold using normalized control: Thu Oct  6 14:44:17 CDT 2022
Creating thresholded feature file: Thu Oct  6 14:45:15 CDT 2022
Empirical false discovery rate = 0.0304317055909412
Merging nearby features and eliminating control-enriched features: Thu Oct  6 14:45:26 CDT 2022
Removing temporary files: Thu Oct  6 14:45:27 CDT 2022
Done: Thu Oct  6 14:45:28 CDT 2022
Calling enriched regions with control file
Normalizing control to experimental bedgraph
Using relaxed threshold
Creating experimental AUC file: Thu Oct  6 14:45:29 CDT 2022
Creating control AUC file: Thu Oct  6 14:45:43 CDT 2022
Calculating optimal AUC threshold: Thu Oct  6 14:45:55 CDT 2022
Calculating threshold using normalized control: Thu Oct  6 14:45:55 CDT 2022
Creating thresholded feature file: Thu Oct  6 14:46:48 CDT 2022
Empirical false discovery rate = 0.0296236989591674
Merging nearby features and eliminating control-enriched features: Thu Oct  6 14:46:57 CDT 2022
Removing temporary files: Thu Oct  6 14:46:57 CDT 2022
Done: Thu Oct  6 14:46:57 CDT 2022

------------------------------------------------------------
Sender: LSF System <lsfadmin@noderome120>
Subject: Job 170665607[8]: <macs2[1-8]> in cluster <hpcf_research_cluster> Done

Job <macs2[1-8]> was submitted from host <noderome174> by user <rfeng> in cluster <hpcf_research_cluster> at Thu Oct  6 11:07:23 2022
Job was executed on host(s) <noderome120>, in queue <standard>, as user <rfeng> in cluster <hpcf_research_cluster> at Thu Oct  6 13:22:34 2022
</home/rfeng> was used as the home directory.
</research/dept/hem/common/sequencing/chenggrp/Ruopeng_CUTRUN/100622_CUTRUN/DrT> was used as the working directory.
Started at Thu Oct  6 13:22:34 2022
Terminated at Thu Oct  6 14:46:57 2022
Results reported at Thu Oct  6 14:46:57 2022

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input


#BSUB -P cut_run
#BSUB -o cut_run_rfeng_2022-10-06.macs2.message_%J_%I.out -e cut_run_rfeng_2022-10-06.macs2.message_%J_%I.err
#BSUB -n 1
#BSUB -q standard
#BSUB -R "span[hosts=1] rusage[mem=80000]"
#BSUB -J "macs2[1-8]"
module purge
#BSUB -w "ended(170665602)"
module load samtools/1.10
module load bedtools/2.29.2
module load conda3
source activate /home/yli11/.conda/envs/py2
module load gcc/6.3.0
export PATH=$PATH:"/home/yli11/HemTools/bin"
module load R/3.5.1

id=$LSB_JOBINDEX
COL1=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $1}'`
COL2=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $2}'`
COL3=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $3}'`
COL4=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $4}'`
COL5=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $5}'`
COL6=`head -n $id peakcall.tsv|tail -n1|awk -F "	" '{print $6}'`
LINE=`head -n $id peakcall.tsv|tail -n1`

module load conda3
source activate /home/yli11/.conda/envs/r_env
samtools view -b ${COL1}.markdup.bam chr1 > ${COL1}.chr1.ef57cd916021.bam;samtools index ${COL1}.chr1.ef57cd916021.bam
run_ATACseqQC.R ${COL1}.chr1.ef57cd916021.bam hg19
rm ${COL1}.chr1.ef57cd916021.bam*
module load macs2/2.1.1
macs2 callpeak -t ${COL1}.bam -c ${COL2}.bam -f BAMPE -B --keep-dup all -n ${COL3}
macs2 bdgcmp -t ${COL3}_treat_pileup.bdg -c ${COL3}_control_lambda.bdg -m qpois -o ${COL3}_treat_pvalue.bdg
macs2 bdgcmp -t ${COL3}_treat_pileup.bdg -c ${COL3}_control_lambda.bdg -m FE -o ${COL3}_FE.bdg
macs2 bdgcmp -t ${COL3}_treat_pileup.bdg -c ${COL3}_control_lambda.bdg -m logLR -o ${COL3}_logLR.bdg -p 0.01
macs2 bdgpeakcall -i ${COL3}_treat_pvalue.bdg -c 1.301 -l 100 -g 75 -o ${COL3}_bdgpeaks.bed
bedtools intersect -a ${COL3}_peaks.narrowPeak -b /research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../hg19/hg19.blacklist.bed -v > ${COL3}_peaks.rmblck.narrowPeak
bedtools intersect -a ${COL3}_bdgpeaks.bed -b /research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../hg19/hg19.blacklist.bed -v > ${COL3}_bdgpeaks.rmblck.bed
annot_gene_features.py -f ${COL3}_peaks.rmblck.narrowPeak -o ${COL3}_peaks.rmblck.narrowPeak.annot.tsv -g hg19
pie_plot.py -f ${COL3}_peaks.rmblck.narrowPeak.annot.tsv --order Exon,Promoter,5UTR,3UTR,Intron,Intergenic --use_col -1 --header -o ${COL3}_peaks.rmblck.narrowPeak.genomic_features.pie_chart
module load python/2.7.13;/home/yli11/HemTools/bin/calculate_FRiP.py ${COL1}.bam ${COL3}_peaks.rmblck.narrowPeak CHIP
/research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../bin/wigToBigWig ${COL3}_treat_pvalue.bdg /research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../hg19/hg19.chrom.sizes ${COL3}_treat_pvalue.bw
/research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../bin/wigToBigWig ${COL3}_FE.bdg /research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../hg19/hg19.chrom.sizes ${COL3}_FE.bw
/research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../bin/wigToBigWig ${COL3}_logLR.bdg /research/dept/hem/common/sequencing/chenggrp/pipelines/subcmd/../hg19/hg19.chrom.sizes ${COL3}_logLR.bw
module load conda3
source activate /home/yli11/.conda/envs/r_env
samtools view -b ${COL1}.rmdup.uq.rmchrM.markdup.bam chr1 > ${COL1}.rmdup.uq.rmchrM.chr1.ef57cd916021.bam;samtools index ${COL1}.rmdup.uq.rmchrM.chr1.ef57cd916021.bam
run_ATACseqQC.R ${COL1}.rmdup.uq.rmchrM.chr1.ef57cd916021.bam hg19

(... more ...)
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   4739.93 sec.
    Max Memory :                                 20249 MB
    Average Memory :                             1693.69 MB
    Total Requested Memory :                     80000.00 MB
    Delta Memory :                               59751.00 MB
    Max Swap :                                   -
    Max Processes :                              8
    Max Threads :                                68
    Run time :                                   5064 sec.
    Turnaround time :                            13174 sec.

The output (if any) is above this job summary.



PS:

Read file <cut_run_rfeng_2022-10-06.macs2.message_170665607_8.err> for stderr output of this job.

